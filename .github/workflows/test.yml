name: Debug Session Files

on:
  workflow_dispatch:

jobs:
  debug:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repo
        uses: actions/checkout@v4

      - name: Setup Python
        uses: actions/setup-python@v5
        with:
          python-version: "3.11"

      - name: Install dependencies
        run: pip install pyrogram

      - name: Simple debug (без heredoc)
        run: |
          echo "=== Шаг 1: Проверяем секрет ==="
          echo "Длина секрета: ${#USER_SESSION_B64}"
          
          echo "=== Шаг 2: Создаем user.session ==="
          echo "${{ secrets.USER_SESSION_BASE64 }}" | base64 -d > user.session
          
          echo "=== Шаг 3: Проверяем файл ==="
          ls -l user.session
          echo "Размер файла: $(wc -c < user.session) байт"
          
          echo "=== Шаг 4: Заголовок файла (первые 16 байт) ==="
          head -c 16 user.session | xxd
          
          echo "=== Шаг 5: Содержимое директории ==="
          ls -la
